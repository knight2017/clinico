<h1>Hello <%= "#{@user.full_name}" %></h1>
<div class="hiddenId" style="display:none;"><%= @user.id %></div>
<div id="calendar"></div>

<%= simple_form_for @user do |f| %>
  <%= f.input :first_name %>
  <%= f.input :last_name %>
  <%= f.input :email %>
  <%= f.button :submit, class: "btn-primary" %>
<% end %>
<br>
<%= link_to "Change Password", edit_user_path(@user) %>

<script>
$(document).ready(function() {
  var events;
  var userId = $('.hiddenId').html()


  $('#calendar').on('click', '.fa-trash', function(){


    var docName = $('div.fc-title').html();
    var appId   = $(this).next().data('id');
    console.log(appId);
    swal({
      imageUrl: 'http://vignette2.wikia.nocookie.net/nintendo/images/b/be/Boo_Icon.png/revision/latest/scale-to-width-down/240?cb=20120506182024&path-prefix=en',
     title: "Cancel apppointment?",
     text: "you want to cancel appointment with "+docName,
     showCancelButton: true,
     confirmButtonColor: "#DD6B55",
     confirmButtonText: "Yes, cancel it!",   cancelButtonText: "No, cancel plx!",   closeOnConfirm: false,
     closeOnCancel: false },
     function(isConfirm){
       if (isConfirm) {
         $.ajax({
             method: "PATCH",
             url: "/appointments/"+appId+'/cancel',
             data: {appointment: {id: appId}},
         }).done(function(){
           swal("Appointment Cancelled!", "Your imaginary file has been deleted.", "success");
         }).fail(function(){
           swal({
             title: "Error!",
             imageUrl: 'http://www.mariowiki.com/images/0/01/Goomba_Cut-in_PD-SMBE.png',
           text: "A error has occured, please try again later!"});
         });
       } else {
         swal({
           imageUrl: 'http://vignette2.wikia.nocookie.net/nintendo/images/f/f4/Koopa_Icon.png/revision/latest?cb=20120820190332&path-prefix=en',
           title: "Appointment Unchanged",
           text: "I will close in 2 seconds.",
           timer: 2000,
           showConfirmButton: false });
       }
     });
  })





    $('#calendar').html("")
    $('#calendar').fullCalendar({
      eventLimit: true, // for all non-agenda views
        views: {
            agenda: {
                eventLimit: 6 // adjust to 6 only for agendaWeek/agendaDay
            }
        },

       eventMouseout: function( event, jsEvent, view ) { },
          customButtons: {
            myCustomButton: {
                text: 'custom!',
                click: function() {
                    alert('clicked the custom button!');
                }
            }
        },

      header: {
              left: 'today myCustomButton',
              center: 'prev title next',
              right: 'month,agendaWeek'
          },
      minTime: "07:00:00",
      maxTime: "21:00:00",
      allDaySlot: false,
      defaultView :'agendaWeek',
      height: 600,
      events: '/users/'+userId+'.json',
      eventRender: function(event, eventElement) {
        eventElement.find("div.fc-content").append('<i class="fa fa-trash" aria-hidden="true"></i>')
        eventElement.find("div.fc-content").append('<i class="appointmentId" data-id="'+event.id+'" style="display:none;"></i>')
      }
      });
 $('.fc-widget-header').addClass('user');







});
</script>
